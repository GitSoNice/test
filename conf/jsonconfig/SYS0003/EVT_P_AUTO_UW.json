[
    {
        "sourceSystem":"SYS0003",
        "targetTableName":"EVT_P_AUTO_UW",
        "order":"1",
        "combinationMap":[
   
            {
                "alias":"app_agmt_id",
                "specialHandle":{
                    "handleName":"agmtId",
                    "parameters":[
                        "${POLICY.applicationno}",
                        "${POLICY.branchcode}"
                    ]
                }
            },
            {
                "alias":"decoderesult",
                "specialHandle":{
                    "handleName":"decode",
                    "parameters":[
                        "${POLICY.fleetagreementno}",
                        "",
                        "0",
                        "1"
                    ]
                }
            }
        ],
        "rowKey":[
            "${app_agmt_id}",
            "${app_agmt_id}"
        ],
        "sourcePrimaryTable":{
            "tableName":"SYS0003.MAX_POLICY",
            "alias":"POLICY"
        },
        "relations":[
        	{
                "sourceTableName":"SYS0003.DOCUMENTPRINT",
                "relationType":"left",
                "alias":"DOCUMENTPRINT",
                "on":{
                    "operatorSymbol":"and",
                    "conditionList":[
                        {
                            "conditionType":"simple",
                            "conditionContext":{
                                "expression":{
                                    "expressionType":"=",
                                    "dataType":"String",
                                    "formatter":""
                                },
                                "leftCondition":"${DOCUMENTPRINT.policyid}",
                                "rightCondition":"${POLICY.policyid}"
                            }
                        }
                    ]
                },
				"filter":{
                    "operatorSymbol":"and",
                    "conditionList":[
                        {
                            "conditionType":"simple",
                            "conditionContext":{
                                "expression":{
                                    "expressionType":"In",
                                    "dataType":"String",
                                    "formatter":""
                                },
                                "leftCondition":"${DOCUMENTPRINT.documenttype}",
                                "rightCondition":"02,03"
                            }
                        }
                    ]
                }
            },
            {
                "sourceTableName":"SYS0003.ROLE",
                "relationType":"left",
                "alias":"ROLE",
                "on":{
                    "operatorSymbol":"and",
                    "conditionList":[
                        {
                            "conditionType":"simple",
                            "conditionContext":{
                                "expression":{
                                    "expressionType":"=",
                                    "dataType":"String",
                                    "formatter":""
                                },
                                "leftCondition":"${ROLE.topactualid}",
                                "rightCondition":"${POLICY.actualid}"
                            }
                        }
                    ]
                },
                "filter":{
                    "operatorSymbol":"and",
                    "conditionList":[
                        {
                            "conditionType":"simple",
                            "conditionContext":{
                                "expression":{
                                    "expressionType":"=",
                                    "dataType":"String",
                                    "formatter":""
                                },
                                "leftCondition":"${ROLE.kind}",
                                "rightCondition":"PREMIUMFLOATINGITEM2014"
                            }
                        }
                    ]
                }
            },
            {
                "sourceTableName":"SYS0003.PREMIUMFLOATING",
                "relationType":"left",
                "alias":"PREMIUMFLOATING",
                "on":{
                    "operatorSymbol":"and",
                    "conditionList":[
                        {
                            "conditionType":"simple",
                            "conditionContext":{
                                "expression":{
                                    "expressionType":"=",
                                    "dataType":"String",
                                    "formatter":""
                                },
                                "leftCondition":"${PREMIUMFLOATING.actualid}",
                                "rightCondition":"${ROLE.actualid}"
                            }
                        }
                    ]
                }
            },
            {
                "sourceTableName":"SYS0003.VEHICLE",
                "relationType":"inner",
                "alias":"VEHICLE",
                "on":{
                    "operatorSymbol":"and",
                    "conditionList":[
                        {
                            "conditionType":"simple",
                            "conditionContext":{
                                "expression":{
                                    "expressionType":"=",
                                    "dataType":"String",
                                    "formatter":""
                                },
                                "leftCondition":"${VEHICLE.topactualid}",
                                "rightCondition":"${POLICY.actualid}"
                            }
                        }
                    ]
                }
            },
            {
                "sourceTableName":"SYS0003.PROPERTY_POLICY",
                "relationType":"left",
                "alias":"PROPERTY_POLICY",
                "on":{
                    "operatorSymbol":"and",
                    "conditionList":[
                        {
                            "conditionType":"simple",
                            "conditionContext":{
                                "expression":{
                                    "expressionType":"=",
                                    "dataType":"String",
                                    "formatter":""
                                },
                                "leftCondition":"${PROPERTY_POLICY.policy_id}",
                                "rightCondition":"${POLICY.actualid}"
                            }
                        }
                    ]
                }
            }
        ],
        "where":{
            "operatorSymbol":"and",
            "conditionList":[
                {
                    "conditionType":"simple",
                    "conditionContext":{
                        "expression":{
                            "expressionType":"=",
                            "dataType":"String",
                            "formatter":""
                        },
                        "leftCondition":"${POLICY.currentflag}",
                        "rightCondition":"Y"
                    }
                }
            ]
        },
        "columnList":[
            {
                "srcColumnName":"${app_agmt_id}",
                "dstColumnName":"app_agmt_id",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.branchcode}",
                "dstColumnName":"branchcode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.activitycode}",
                "dstColumnName":"market_activflg",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PREMIUMFLOATING.claimadjustreason}",
                "dstColumnName":"no_fl_reasoncode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.aidingfund}",
                "dstColumnName":"aid_fund",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.aidingfundproportion}",
                "dstColumnName":"aid_fund_rate",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.applicationdate}",
                "dstColumnName":"app_dt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.arbitrationorgname}",
                "dstColumnName":"arbit_org",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.uniformincode}",
                "dstColumnName":"blanketcode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.sellingchannel}",
                "dstColumnName":"biz_chn",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.businessvariety}",
                "dstColumnName":"biz_class",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.underwritingdate}",
                "dstColumnName":"aud_dt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.coinsuragreementno}",
                "dstColumnName":"agmt_no",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.agentdeptcode}",
                "dstColumnName":"deptcode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.agentdeptgroupcode}",
                "dstColumnName":"dept_grpcode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.recorddate}",
                "dstColumnName":"input_dt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PREMIUMFLOATING.nonclaimdiscountrate}",
                "dstColumnName":"no_claim_discnt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PREMIUMFLOATING.traffictransgressrate}",
                "dstColumnName":"viol_fl_coef",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${decoderesult}",
                "dstColumnName":"is_grp",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.inceptiondate}",
                "dstColumnName":"inception_dt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.inputorid}",
                "dstColumnName":"input_operrcode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.recordmode}",
                "dstColumnName":"input_mode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.agriculturerelated}",
                "dstColumnName":"is_agr",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.issuedate}",
                "dstColumnName":"issue_dt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.endorsementno}",
                "dstColumnName":"last_endorno",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.litigationarbitration}",
                "dstColumnName":"litig_mode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.lifeagent}",
                "dstColumnName":"life_salercode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${VEHICLE.loanvehicleflag}",
                "dstColumnName":"loan_vehicflg",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.insuredcount}",
                "dstColumnName":"uw_qtty",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.inputorid}",
                "dstColumnName":"offer_operno",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.agentid}",
                "dstColumnName":"operno",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.terminationdate}",
                "dstColumnName":"end_dt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.floatingrate}",
                "dstColumnName":"fl_rate",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.applicationno}",
                "dstColumnName":"appno",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.policystatus}",
                "dstColumnName":"status",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${DOCUMENTPRINT.printtime}",
                "dstColumnName":"print_tm",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${DOCUMENTPRINT.printercode}",
                "dstColumnName":"printercode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.productcode}",
                "dstColumnName":"classcode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.agreementcompanycode}",
                "dstColumnName":"rel_compcode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.linkedpolicyno}",
                "dstColumnName":"rel_policyno",
                "validate":"",   
                "priority":""
            },
{
                "srcColumnName":"PT",
                "dstColumnName":"risktype",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.sellingchannel}",
                "dstColumnName":"saleattr",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.the4scode}",
                "dstColumnName":"the4scode",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.sumassured}",
                "dstColumnName":"totamt",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${POLICY.premium}",
                "dstColumnName":"tot_prem",
                "validate":"",
                "priority":""
            },
{
                "srcColumnName":"${PROPERTY_POLICY.annualpremium}",
                "dstColumnName":"prem_year",
                "validate":"",
                "priority":""
            },
            {
                "srcColumnName":"SYS0003",
                "dstColumnName":"src_sys",
                "validate":"",
                "priority":""
            },
            {
                "srcColumnName":"SYS0003",
                "dstColumnName":"upd_sys",
                "validate":"",
                "priority":""
            },
            {
                "srcColumnName":"${POLICY.createdate}",
                "dstColumnName":"crt_tm",
                "validate":"",
                "priority":""
            },
            {
                "srcColumnName":"${POLICY.updatedate}",
                "dstColumnName":"upd_tm",
                "validate":"",
                "priority":""
            },
            {
                "srcColumnName":"${POLICY.sectioncode}",
                "dstColumnName":"officecode",
                "validate":"",
                "priority":""
            }
            
            
        ]
    }
]