[
	{
		"sourceSystem":"SYS0002",
	    "targetTableName":"CON_P_NOAUTO_POLICY",
	    "order":"1",
	    "sourcePrimaryTable":{
	        "tableName":"SYS0002.P_PUBLIC_POLICY",
	        "alias":"POLICY"
	    },
	    "combinationMap":[
	        {
	            "alias":"agmt_id",
	            "specialHandle":
	            {
	                "handleName":"agmtId",
	                "parameters":[
	            		"${POLICY.policyno}",
	            		"${POLICY.unitcode}"
	            	]
	            }
	        },
	        {
	            "alias":"starttime",
	            "specialHandle":
	            {
	                "handleName":"timeTo2Handler",
	                "parameters":[
	            		"${POLICY.starttime}"
	            	]
	            }
	        },
			{
	            "alias":"inception_dt_var",
	            "specialHandle":
	            {
	                "handleName":"contact",
	                "parameters":[
	                    {
	                       "handleName":"substring",
	                       "parameters":[
	                           "${POLICY.startdate}",
							   "0",
							   "10"
	                       ]
	                    },
	                    " ",
						"${starttime}"
	                ]
	            }
	        },
	        {
	            "alias":"endtime",
	            "specialHandle":
	            {
	                "handleName":"timeTo2Handler",
	                "parameters":[
	            		"${POLICY.endtime}"
	            	]
	            }
	        },
			{
	            "alias":"planned_end_dt_var",
	            "specialHandle":
	            {
	                "handleName":"contact",
	                "parameters":[
	                    {
	                       "handleName":"substring",
	                       "parameters":[
	                           "${POLICY.enddate}",
							   "0",
							   "10"
	                       ]
	                    },
	                    " ",
						"${endtime}"
	                ]
	            }
	        }
	    ],
	    "rowKey":[
	        "${agmt_id}",
	        "${agmt_id}"
	    ],
	    "relations":[
	    	{
	    		"sourceTableName":"SYS0002.P_PUBLIC_SPEC",
	    		"alias":"SPEC",
	    		"relationType":"left",
	    		"on":{
				    "operatorSymbol":"and",
				    "conditionList":[
					    {
					       "conditionType":"simple",
	    			       "conditionContext":{
                              "expression":{
                        	    "expressionType":"=",
                        	    "dataType":"String",
                        	    "formatter":""
                              },
                              "leftCondition":"${POLICY.unitcode}",
                              "rightCondition":"${SPEC.unitcode}"
	                       }
						},
						{
					       "conditionType":"simple",
	    			       "conditionContext":{
                              "expression":{
                        	    "expressionType":"=",
                        	    "dataType":"String",
                        	    "formatter":""
                              },
                              "leftCondition":"${POLICY.applyno}",
                              "rightCondition":"${SPEC.applyno}"
	                       }
						},
						{
					       "conditionType":"simple",
	    			       "conditionContext":{
                              "expression":{
                        	    "expressionType":"=",
                        	    "dataType":"String",
                        	    "formatter":""
                              },
                              "leftCondition":"${POLICY.applyendorseno}",
                              "rightCondition":"${SPEC.applyendorseno}"
	                       }
						}
					]
	    			
	    		}
	    	}
	    ],
	    "where":{
	    	"operatorSymbol":"and",
	    	"conditionList":[
			    {
	    			"conditionType":"simple",
	    			"conditionContext":{
	    				"expression":
	    				{
	                    	"expressionType":"=",
	                    	"dataType":"String",
	                    	"formatter":""
	                    },
	                    "leftCondition":"${POLICY.generateorder}",
	                    "rightCondition":"0"
	    			}
	    		},
				{
	    			"conditionType":"simple",
	    			"conditionContext":{
	    				"expression":
	    				{
	                    	"expressionType":"<>",
	                    	"dataType":"String",
	                    	"formatter":""
	                    },
	                    "leftCondition":"${POLICY.policyno}",
	                    "rightCondition":""
	    			}
	    		},
				{
	    			"conditionType":"simple",
	    			"conditionContext":{
	    				"expression":
	    				{
	                    	"expressionType":"<>",
	                    	"dataType":"String",
	                    	"formatter":""
	                    },
	                    "leftCondition":"${POLICY.unitcode}",
	                    "rightCondition":""
	    			}
	    		}
	    	]
	    },
	    "columnList":
	    [
	    	{
	            "srcColumnName":"${agmt_id}",
	            "dstColumnName":"agmt_id",
	            "validate":"",
	            "priority":""
	        },
	        {
	            "srcColumnName":"${POLICY.policyno}",
	            "dstColumnName":"policyno",
	            "validate":"",
	            "priority":""
	        },
	        {
	            "srcColumnName":"${POLICY.unitcode}",
	            "dstColumnName":"branchcode",
	            "validate":"",
	            "priority":""
	        },
	        {
	            "srcColumnName":{
				    "handleName":"decode",
	                "parameters":[
	            		"${SPEC.businesstype}",
	            		"",
						"${POLICY.istorg}",
						"${SPEC.businesstype}"
	            	]
				},
	            "dstColumnName":"is_grp",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.applyno}",
	            "dstColumnName":"appno",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.classescode}",
	            "dstColumnName":"classcode",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.applyname}",
	            "dstColumnName":"app_name",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.underwritertype}",
	            "dstColumnName":"app_certtype",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.certificatenumber}",
	            "dstColumnName":"app_certno",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.insurantname}",
	            "dstColumnName":"insured_name",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.attestation}",
	            "dstColumnName":"insured_certtype",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.credentialsnumber}",
	            "dstColumnName":"insured_certno",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.status}",
	            "dstColumnName":"status",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.sellchannel}",
	            "dstColumnName":"saleattr",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.insuretype}",
	            "dstColumnName":"uw_mode",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.specialize}",
	            "dstColumnName":"spec_appoint",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.signdate}",
	            "dstColumnName":"issue_dt",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.applydate}",
	            "dstColumnName":"app_dt",
	            "validate":"",
	            "priority":""
	        },
			{   
	            "srcColumnName":"${inception_dt_var}",
	            "dstColumnName":"inception_dt",
	            "validate":"",
	            "priority":""
	        },
			{   
	            "srcColumnName":"${planned_end_dt_var}",
	            "dstColumnName":"planned_end_dt",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.opdate}",
	            "dstColumnName":"crt_tm",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.lastoptime}",
	            "dstColumnName":"upd_tm",
	            "validate":"",
	            "priority":""
	        },
			{
	            "srcColumnName":"${POLICY.agentcode}",
	            "dstColumnName":"agtcode",
	            "validate":"",
	            "priority":""
	        }
	    ]
	}
]

